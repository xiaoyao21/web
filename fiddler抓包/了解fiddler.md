## Fiddler介绍
Fiddler是一个http抓包改包工具，fiddle英文中有“欺骗、伪造”之意，与wireshark相比它更轻量级，上手简单，因为只能抓http和https数据包，所以在针对http和https数据包的抓取上它更加专业。

不仅可以记录客户端和服务器的http(s)请求，还能设置断点，修改请求和响应的数据，模拟弱网络环境。如果这些还满足不了你的需求，你还可以安装插件对Fiddler现有的功能进行扩展，甚至编写脚本实现一些自动化操作。

## Fiddler的工作原理
当我们浏览网页的时候，实际上浏览器会通过tcp连接以http数据包的形式向服务器发起请求的，服务器在接收到请求后会根据后台代码逻辑做出不同的响应。

以上是系统中没有代理，用的是直连网络的情况。这时候如果系统中设置了静态http代理，那么浏览器所有外发的http请求会被重定向到代理服务器，代理服务器会根据请求的目的ip将请求再转发至相应的服务器。同理，服务器返回给浏览器的数据也要经过代理这一层。

其实Fiddler所做的和代理服务器是一样的事情，当我们启用Fiddler之后，ie的http(s)代理会自动被设置为127.0.0.1:8888(之所以这么设置是因为Fiddler是在本地8888端口进行监听的)， 所有http(s)会话的都会被Fiddler拦截。

## 抓取HTTPS原理
ttps实际通信过程可以分为两步走：

第一步，客服端和服务器协商通信使用的密钥（对称密钥）。

这个过程可以简单描述为——客户端发起请求获取服务器的证书，证书里包含了服务器的RSA公钥。客户端生成通信用的对称密钥，使用服务器的公钥加密后传输给服务器。服务器接收到之后使用自己的RSA私钥解密得到传输用的明文秘钥。

第二步，客服端和服务器使用协商好的密钥进行加密通信。

了解以上常识后我们再看Fiddler解密https的过程其实不难：

1. 客户端发起请求，中间人（Fiddler）会拦截来自客户端的请求，并将伪造的ca证书派发给客户端。同时Fiddler向服务器请求，获得服务器的ca证书。
2. 客户端接收到来自中间人（Fiddler）的证书，还傻傻的以为这个证书是来自服务器的，并且使用证书里的公钥（其实是Fiddler的公钥）对生成的通信秘钥（对称密钥）加密，发送给服务器。可怜的是这个数据包也会被中间人（Fiddler）拦截。
3. 中间人（Fiddler）使用自己的私钥将数据包解密，很轻松地得到了通信秘钥。之后使用服务器的RSA公钥对通信密钥加密后传输给服务器。
4. 服务器接收到“客户端”（其实是Fiddler）发送给自己的密钥，使用RSA私钥解密得到明文密钥后，建立信任。握手完成。使用对称密钥加密消息， 开始通信。
5. 后面的事情大家应该就明白了，由于Fiddler持有通信秘钥，客户端和服务器的通信对其始终是透明的。这篇文章里有更加详细的描述，文章链接：http://www.mehdi-khalili.com/Fiddler-in-action/part-1/

## HTTP请求报文
浏览器相当于请求的是对应服务器目录上的资源：
* 请求行  

       请求方法 
       统一资源定位符 URL（Uniform Resource Location）
                格式：schema://host[:port#]/path/.../[?query-string]
                schema：协议 http https
                host：域名或者IP地址 
                port：端口  （找到的对应进行数据通讯的程序）默认为80
                path：资源的路径
                query-string：发送的参数（？key=value&key2=value）
                
       HTTP协议及版本号的说明 

* 请求头部

* 空一行
* 请求正文（请求体）

### 响应报文
 * 状态码
 
用以表示网页服务器HTTP响应状态的3为数字代码

        状态码                                描述
        1XX                     提示信息，请求被成功接收
        2XX                     成功，请求被成功处理 200
        3XX                     重定向相关 304 （eg：页面在之前打开的时候被放入缓存）
        4XX                     客户端错误 404
        5XX                     服务器端错误 500

## 工具介绍
抓取的网站：
http://test.lemonban.com/ningmengban/app/login/login.html

快捷键 &工具介绍
```
Replay 重新发送
循环一次：选中+R
循环请求多次： 选中+shift R  

删除
全部删除ctrl X
删除除某项的所有：选取+shift+del

Go转到下一步

断点：
点击一下：发送前断点（相当于在从客户端向服务器发送请求的过程中被fiddler阻拦）

Stream
流模式（服务器返回什么东西立马返回给前端） (除了流模式fiddler还有一个缓冲模式)

Any process 指定抓取的程序

Clear Cache 清除ie缓存

TextWizard 编码解码工具

Tearoff  分离面板
```
* 会话列表 Session List
Fiddler 抓取到的每一条http请求（每一条请求成为一个session）

* 最下面的黑框 可以输入命令 （help 可以查看命令）
* Capturing 处理代理的状态

* Statistics 统计
HTTP请求的性能和其他数据分析，DNS解析的事件，建立TCP/IP链接消耗的时间

* Inspectors 查看请求报文和响应报文
* AutoResponder 自动响应器

可用于拦截某一请求。

        重定向到本地的资源
        使用Fiddler的内置响应
        自定义响应
        
* Composer 设计者

是一个简单的发包的工具

        可用于接口测试
* Filter 

多维度的过滤器  可以抓取我们想要的请求 （eg：设置抓取的）

* 请求前断点，再将请求发往服务的过程中，截断，此时可以更改发送的信息
        
        bpu 请求前的断点
        bpafter 请求后的断点
        

[【十分钟学会 Fiddler】](https://cloud.tencent.com/developer/article/1004890)